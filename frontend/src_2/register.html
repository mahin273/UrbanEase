<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UrbanEase - Register</title>
  <link rel="stylesheet" href="main.css">
</head>

<body>
  <div class="min-h-screen py-40" style="background-image: linear-gradient(115deg, #9F7AEA, #FEE2FE);">
    <div class="container mx-auto">
      <div class="flex flex-col lg:flex-row w-10/12 lg:w-8/12 bg-white rounded-xl mx-auto shadow-lg overflow-hidden">
        <!-- Image Section -->
        <div class="w-fit lg:w-1/2 flex-col items-center justify-center p-12 bg-no-repeat bg-cover bg-center"
          style="background-image: url('welcome.jpg'); background-size: 100%;"></div>

        <!-- Registration Form Section -->
        <div class="w-full lg:w-1/2 py-16 px-12">
          <h2 class="text-4xl font-bold font-serif text-stone-950">Register</h2>
          <p class="mb-4 font-serif">
            <br>
            Create your account. Itâ€™s free and only takes a minute.
          </p>

          <!-- Form -->
          <form id="registerForm" class="flex flex-col gap-4">
            <!-- First Name -->
            <div class="mt-5">
              <input type="text" name="firstname" placeholder="First Name"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Last Name -->
            <div class="mt-5">
              <input type="text" name="lastname" placeholder="Last Name"
                class="border font-serif rounded-xl py-1 px-2 w-full">
            </div>

            <!-- Username -->
            <div class="mt-5">
              <input type="text" name="username" placeholder="Username"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- NID Number -->
            <div class="mt-5">
              <input type="text" name="nid_num" placeholder="NID Number"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Email -->
            <div class="mt-5">
              <input type="email" name="email" placeholder="Email" class="border font-serif rounded-xl py-1 px-2 w-full"
                required>
            </div>

            <!-- Gender -->
            <div class="mt-5">
              <input type="text" name="gender" placeholder="Gender (Male, Female, Others)"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Date of Birth (Birthday Calendar) -->
            <div class="mt-5">
              <input type="date" name="dob" class="border font-medium rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Password -->
            <div class="mt-5">
              <input type="password" name="password" placeholder="Password"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Confirm Password -->
            <div class="mt-5">
              <input type="password" name="confirmPassword" placeholder="Confirm Password"
                class="border font-serif rounded-xl py-1 px-2 w-full" required>
            </div>

            <!-- Terms and Conditions -->
            <div class="mt-5">
              <input type="checkbox" name="terms" class="border border-gray-400" required>
              <span class="font-serif">
                I accept the <a href="#" class="text-purple-500 font-semibold">Terms of Use</a> & <a href="#"
                  class="text-purple-500 font-semibold">Privacy Policy</a>
              </span>
            </div>

            <!-- Submit Button -->
            <div class="mt-5">
              <button type="submit"
                class="w-full bg-purple-500 py-3 text-center rounded-xl text-white font-serif hover:scale-105 duration-300">
                Register Now
              </button>
            </div>
          </form>

          <!-- Footer Message -->
          <div>
            <p class="font-serif text-black p-5 relative -bottom-6 text-justify">UrbanEase is here to make you feel
              that your local community really cares. <a href="#" class="text-purple-500 font-semibold">Learn
                more</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript for Form Submission -->
  <script>
    document.getElementById('registerForm').addEventListener('submit', async (event) => {
      event.preventDefault(); // Prevent default form submission

      // Collect form data
      const formData = new FormData(event.target);
      const data = {
        firstname: formData.get('firstname'),
        lastname: formData.get('lastname'),
        username: formData.get('username'),
        nid_num: formData.get('nid_num'),
        email: formData.get('email'),
        gender: formData.get('gender'),
        dob: formData.get('dob'),
        password: formData.get('password'),
        confirmPassword: formData.get('confirmPassword'),
        // No need to collect role from the form
      };

      // Validate passwords match
      if (data.password !== data.confirmPassword) {
        alert('Passwords do not match!');
        return;
      }

      try {
        // Send data to the backend
        const response = await fetch('http://localhost:4001/api/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          const result = await response.json();
          alert('Registration successful! Welcome, ' + data.username + '!');
          event.target.reset(); // Clear the form
        } else {
          const error = await response.json();
          alert('Error: ' + error.error);
        }
      } catch (err) {
        alert('Error connecting to the server. Please try again later.');
      }
    });
  </script>
</body>

</html>